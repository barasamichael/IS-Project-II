<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="{{ csrf_token }}">
    <title>{% block title %}SettleBot - Your Settlement Assistant for International Students in Nairobi{% endblock %}</title>

    <!-- Primary Meta Tags -->
    <meta name="title" content="{% block meta_title %}SettleBot - AI-Powered Settlement Assistant for International Students{% endblock %}">
    <meta name="description" content="{% block meta_description %}Get instant, accurate guidance for settling in Nairobi as an international student. Find accommodation, navigate admin processes, and access essential services with AI-powered assistance.{% endblock %}">
    <meta name="keywords" content="international students, Nairobi, settlement assistance, accommodation, university services, Kenya, AI assistant, student support">
    <meta name="author" content="SettleBot">
    <meta name="robots" content="index, follow">

    <!-- Open Graph / Social Media -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ request.url }}">
    <meta property="og:title" content="{% block og_title %}SettleBot - AI Settlement Assistant for International Students in Nairobi{% endblock %}">
    <meta property="og:description" content="{% block og_description %}Get personalized settlement guidance for international students in Nairobi. Navigate admin processes, find accommodation, and access essential services.{% endblock %}">
    <meta property="og:image" content="{{ url_for('static', filename='img/logo.png', _external=True) }}">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- Favicon -->
    <link rel="shortcut icon" href="{{ url_for('static', filename='img/logo.png') }}" type="image/x-icon">
    <link rel="icon" href="{{ url_for('static', filename='img/logo.png') }}" type="image/x-icon">
    <link rel="stylesheet" href="/static/css/base.css">

    <style>
        {% block extra_css %}{% endblock %}
    </style>
  </head>
  <body>
    {% block header %}
    <header class="header" id="header">
      <div class="nav-container">
        <a href="{{ url_for('main.index') }}" class="logo">SettleBot</a>

        <ul class="nav-menu">
          <li><a href="{{ url_for('main.index') }}">Home</a></li>
          <li><a href="{{ url_for('main.about') }}">About</a></li>
          <li><a href="{{ url_for('main.features') }}">Features</a></li>
          <li><a href="{{ url_for('main.faq') }}">FAQ</a></li>
        </ul>

        {% if current_user.is_authenticated %}
        <div class="user-area">
          <button class="user-trigger" id="userTrigger">
            {{ current_user.fullName.split()[0] }}
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M6 9l6 6 6-6"/>
            </svg>
          </button>
          <div class="user-dropdown" id="userDropdown">
            <a href="{{ url_for('accounts.profile') }}">Profile</a>
            <a href="{{ url_for('accounts.user_conversations') }}">Conversations</a>
            {% if current_user.role == 'admin' %}
            <a href="{{ url_for('administration.dashboard') }}">Admin Dashboard</a>
            {% endif %}
            <a href="{{ url_for('authentication.user_logout') }}">Sign Out</a>
          </div>
        </div>
        {% else %}
        <div class="auth-buttons">
          <a href="{{ url_for('authentication.user_login') }}" class="btn btn-ghost">Sign In</a>
          <a href="{{ url_for('authentication.user_registration') }}" class="btn btn-primary">Get Started</a>
        </div>
        {% endif %}

        <button class="mobile-menu-button" id="mobileMenuButton">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 12h18M3 6h18M3 18h18"/>
          </svg>
          <span class="sr-only">Toggle menu</span>
        </button>
      </div>
    </header>

    <!-- Mobile Menu -->
    <div class="mobile-overlay" id="mobileOverlay"></div>
    <nav class="mobile-menu" id="mobileMenu">
      <div class="mobile-menu-header">
        <span class="logo">SettleBot</span>
        <button class="mobile-close" id="mobileClose">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M18 6L6 18M6 6l12 12"/>
          </svg>
        </button>
      </div>

      <ul class="mobile-nav-links">
        <li><a href="{{ url_for('main.index') }}">Home</a></li>
        <li><a href="{{ url_for('main.about') }}">About</a></li>
        <li><a href="{{ url_for('main.features') }}">Features</a></li>
        <li><a href="{{ url_for('main.faq') }}">FAQ</a></li>
      </ul>

      {% if current_user.is_authenticated %}
      <div class="mobile-user-section">
        <div class="mobile-user-info">Hello, {{ current_user.fullName.split()[0] }}</div>
        <ul class="mobile-nav-links">
          <li><a href="{{ url_for('accounts.profile') }}">Profile</a></li>
          <li><a href="{{ url_for('accounts.user_conversations') }}">Conversations</a></li>
          {% if current_user.role == 'admin' %}
          <li><a href="{{ url_for('administration.dashboard') }}">Admin Dashboard</a></li>
          {% endif %}
          <li><a href="{{ url_for('authentication.user_logout') }}">Sign Out</a></li>
        </ul>
      </div>
      {% else %}
      <div class="mobile-auth">
        <a href="{{ url_for('authentication.user_login') }}" class="btn btn-ghost">Sign In</a>
        <a href="{{ url_for('authentication.user_registration') }}" class="btn btn-primary">Get Started</a>
      </div>
      {% endif %}
    </nav>
    {% endblock %}

    <!-- Notification System -->
    <div class="notification-stack">
      {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
      {% for category, message in messages %}
      {% set notification_type = 'info' if category == 'message' else category %}
      <div class="notification {{ notification_type }}">
        <div class="notification-content">{{ message }}</div>
        <button class="notification-close" onclick="this.parentElement.remove();">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M18 6L6 18M6 6l12 12"/>
          </svg>
        </button>
      </div>
      {% endfor %}
      {% endif %}
      {% endwith %}
    </div>

    <main class="main-content">
      {% block content %}{% endblock %}
    </main>

    {% block footer %}
    <footer class="footer">
      <div class="footer-content">
        <div class="footer-brand">
          <h3>SettleBot</h3>
          <p class="footer-description">
          Your intelligent settlement companion for international students in Nairobi.
          We provide personalized AI guidance to help you navigate administrative processes,
          find accommodation, and access essential services in Kenya's capital.
          </p>
        </div>

        <div class="footer-section">
          <h4>Navigation</h4>
          <ul class="footer-links">
            <li><a href="{{ url_for('main.index') }}">Home</a></li>
            <li><a href="{{ url_for('main.about') }}">About</a></li>
            <li><a href="{{ url_for('main.features') }}">Features</a></li>
            <li><a href="{{ url_for('main.faq') }}">FAQ</a></li>
          </ul>
        </div>

        <div class="footer-section">
          <h4>Legal</h4>
          <ul class="footer-links">
            <li><a href="{{ url_for('main.privacy_policy') }}">Privacy Policy</a></li>
            <li><a href="{{ url_for('main.terms_and_conditions') }}">Terms of Service</a></li>
          </ul>
        </div>

        <div class="footer-section">
          <h4>Contact</h4>
          <div class="contact-info">
            <div class="contact-item">
              <div class="contact-icon">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                  <path d="M22 6l-10 7L2 6"/>
                </svg>
              </div>
              <span>support.team@jisortublow.co.ke</span>
            </div>
            <div class="contact-item">
              <div class="contact-icon">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
                </svg>
              </div>
              <span>+254 114 742 348</span>
            </div>
            <div class="contact-item">
              <div class="contact-icon">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
                  <circle cx="12" cy="10" r="3"/>
                </svg>
              </div>
              <span>Nairobi, Kenya</span>
            </div>
          </div>
        </div>
      </div>

      <div class="footer-bottom">
        <p>&copy; 2025 SettleBot. All rights reserved. Empowering international students to thrive in Nairobi.</p>
      </div>
    </footer>
    {% endblock %}

    {% block dismissed %}
    <script>
      // Header scroll effect
      window.addEventListener('scroll', function() {
        const header = document.getElementById('header');
        if (window.scrollY > 20) {
          header.classList.add('scrolled');
        } else {
          header.classList.remove('scrolled');
        }
      });

      // Mobile menu functionality
      const mobileMenuButton = document.getElementById('mobileMenuButton');
      const mobileMenu = document.getElementById('mobileMenu');
      const mobileOverlay = document.getElementById('mobileOverlay');
      const mobileClose = document.getElementById('mobileClose');

      function openMobileMenu() {
        mobileMenu.classList.add('active');
        mobileOverlay.classList.add('active');
        document.body.style.overflow = 'hidden';
      }

      function closeMobileMenu() {
        mobileMenu.classList.remove('active');
        mobileOverlay.classList.remove('active');
        document.body.style.overflow = '';
      }

      mobileMenuButton.addEventListener('click', openMobileMenu);
      mobileClose.addEventListener('click', closeMobileMenu);
      mobileOverlay.addEventListener('click', closeMobileMenu);

      // Close mobile menu on escape key
      document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape' && mobileMenu.classList.contains('active')) {
          closeMobileMenu();
        }
      });

      // User dropdown functionality
      const userTrigger = document.getElementById('userTrigger');
      const userDropdown = document.getElementById('userDropdown');

      if (userTrigger && userDropdown) {
        userTrigger.addEventListener('click', function(e) {
          e.stopPropagation();
          userDropdown.classList.toggle('show');
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', function() {
          userDropdown.classList.remove('show');
        });

        userDropdown.addEventListener('click', function(e) {
          e.stopPropagation();
        });
      }

      // Smooth scrolling for anchor links
      document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
          const target = document.querySelector(this.getAttribute('href'));
          if (target) {
            e.preventDefault();
            const headerHeight = document.querySelector('.header').offsetHeight;
            const targetPosition = target.offsetTop - headerHeight - 20;

            window.scrollTo({
              top: targetPosition,
              behavior: 'smooth'
            });

            // Close mobile menu if open
            if (mobileMenu.classList.contains('active')) {
              closeMobileMenu();
            }
          }
        });
      });
    </script>
    {% endblock dismissed %}

    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const notifications = document.querySelectorAll('.notification');
        notifications.forEach(notification => {
          setTimeout(() => {
            notification.style.animation = 'slideInFromRight 0.3s ease reverse';
            setTimeout(() => {
              notification.remove();
            }, 300);
          }, 5000);
        });
      });

      // Modal functionality
      function openModal(modalId) {
        const modal = document.getElementById(modalId);
        if (modal) {
          modal.classList.add('show');
          document.body.style.overflow = 'hidden';
        }
      }

      function closeModal(modalId) {
        const modal = document.getElementById(modalId);
        if (modal) {
          modal.classList.remove('show');
          document.body.style.overflow = '';
        }
      }

      // Close modal on backdrop click
      document.addEventListener('click', function(event) {
        if (event.target.classList.contains('modal-backdrop')) {
          event.target.classList.remove('show');
          document.body.style.overflow = '';
        }
      });

      // Close modal on escape key
      document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') {
          const openModal = document.querySelector('.modal-backdrop.show');
          if (openModal) {
            openModal.classList.remove('show');
            document.body.style.overflow = '';
          }
        }
      });

    </script>

    {% block extra_js %}{% endblock %}
  </body>
</html>
